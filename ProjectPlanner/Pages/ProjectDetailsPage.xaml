<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ProjectPlanner.Pages.ProjectDetailsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:ProjectPlanner.Model;assembly=ProjectPlanner.Model"
    BackgroundColor="#121212">

    <VerticalStackLayout Padding="20" Spacing="15">

        <!--  NagÅ‚Ã³wek z przyciskiem usuÅ„  -->
        <HorizontalStackLayout>
            <Label
                FontAttributes="Bold"
                FontSize="28"
                HorizontalOptions="StartAndExpand"
                Text="{Binding Project.Name}"
                TextColor="White"
                VerticalOptions="CenterAndExpand" />
            <Button
                BackgroundColor="Transparent"
                Command="{Binding DeleteProjectCommand}"
                FontSize="26"
                Text="ðŸ—‘"
                TextColor="#FF6666" />
        </HorizontalStackLayout>

        <Label Text="{Binding Project.Description}" TextColor="#A0A0A0" />

        <Label
            Margin="0,10,0,0"
            Text="PostÄ™p:"
            TextColor="#A0A0A0" />

        <ProgressBar
            BackgroundColor="#2A2A2A"
            HeightRequest="8"
            Progress="{Binding Project.Progress}"
            ProgressColor="#89CFF0" />

        <!--  Sekcja SubtaskÃ³w  -->
        <Label
            Margin="0,20,0,10"
            FontAttributes="Bold"
            FontSize="20"
            Text="Zadania:"
            TextColor="#89CFF0" />

        <CollectionView
            ItemsSource="{Binding Project.Subtasks}"
            SelectionChanged="OnSubtaskSelected"
            SelectionMode="Single">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="model:SubTask">
                    <Frame
                        Margin="0,5"
                        BackgroundColor="#1E1E1E"
                        CornerRadius="12">
                        <HorizontalStackLayout>
                            <CheckBox IsChecked="{Binding IsCompleted}" VerticalOptions="Center" />
                            <VerticalStackLayout>
                                <Label
                                    FontAttributes="Bold"
                                    Text="{Binding Title}"
                                    TextColor="White" />
                                <Label
                                    FontSize="13"
                                    Text="{Binding Details}"
                                    TextColor="#A0A0A0" />
                            </VerticalStackLayout>
                            <Button
                                BackgroundColor="Transparent"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteSubtaskCommand}"
                                CommandParameter="{Binding .}"
                                FontSize="20"
                                HorizontalOptions="EndAndExpand"
                                Text="ðŸ—‘"
                                TextColor="#FF6666" />
                        </HorizontalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!--  Przycisk dodawania  -->
        <Button
            Margin="0,20,0,0"
            BackgroundColor="#89CFF0"
            Command="{Binding AddSubtaskCommand}"
            CornerRadius="10"
            HeightRequest="50"
            Text="âž• Dodaj Subtask"
            TextColor="Black" />
    </VerticalStackLayout>
</ContentPage>
