<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ProjectPlanner.Pages.SubtaskDetailsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:converters="clr-namespace:ProjectPlanner.helpers"
    Title="TASK DETAILS"
    BackgroundColor="{StaticResource BackgroundDark}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:BoolToColorConverter x:Key="BoolToColorConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="*, Auto">
        <ScrollView>
            <VerticalStackLayout Padding="24" Spacing="24">

                <Label
                    Margin="0,0,0,-10"
                    FontFamily="TechFont"
                    FontSize="12"
                    Text="// TASK DIAGNOSIS"
                    TextColor="{StaticResource TextSecondary}" />

                <Border
                    BackgroundColor="{StaticResource SurfaceDark}"
                    Stroke="{Binding IsDone, Converter={StaticResource BoolToColorConverter}}"
                    StrokeShape="RoundRectangle 8"
                    StrokeThickness="1">
                    <Grid ColumnDefinitions="*, Auto">
                        <VerticalStackLayout Margin="20">
                            <Label
                                FontFamily="TechFont"
                                FontSize="12"
                                Text="OPERATION STATUS"
                                TextColor="{StaticResource TextSecondary}" />

                            <Label
                                FontAttributes="Bold"
                                FontFamily="HeaderFont"
                                FontSize="20"
                                TextColor="{Binding IsDone, Converter={StaticResource BoolToColorConverter}}">
                                <Label.Triggers>
                                    <DataTrigger
                                        Binding="{Binding IsDone}"
                                        TargetType="Label"
                                        Value="True">
                                        <Setter Property="Text" Value="DONE [OK]" />
                                    </DataTrigger>
                                    <DataTrigger
                                        Binding="{Binding IsDone}"
                                        TargetType="Label"
                                        Value="False">
                                        <Setter Property="Text" Value="ONGOING..." />
                                    </DataTrigger>
                                </Label.Triggers>
                            </Label>
                        </VerticalStackLayout>

                        <Switch
                            Grid.Column="1"
                            IsToggled="{Binding IsDone}"
                            OnColor="{StaticResource NeonAccent}"
                            ThumbColor="{StaticResource Black}"
                            Toggled="OnStatusToggled" />
                    </Grid>
                </Border>

                <VerticalStackLayout Spacing="16">
                    <VerticalStackLayout Spacing="8">
                        <Label
                            FontFamily="HeaderFont"
                            FontSize="14"
                            Text="TASK NAME"
                            TextColor="{StaticResource NeonAccent}" />

                        <Label
                            FontAttributes="Bold"
                            FontFamily="HeaderFont"
                            FontSize="24"
                            Text="{Binding Name}"
                            TextColor="{StaticResource TextPrimary}" />
                    </VerticalStackLayout>

                    <BoxView HeightRequest="1" Color="{StaticResource BorderColor}" />

                    <VerticalStackLayout Spacing="8">
                        <Label
                            FontFamily="HeaderFont"
                            FontSize="14"
                            Text="DESCRIPTION"
                            TextColor="{StaticResource NeonAccent}" />

                        <Border
                            Padding="16"
                            BackgroundColor="{StaticResource SurfaceDark}"
                            MinimumHeightRequest="100"
                            Stroke="{StaticResource BorderColor}"
                            StrokeShape="RoundRectangle 4"
                            StrokeThickness="1">
                            <Label
                                FontFamily="TechFont"
                                FontSize="16"
                                LineHeight="1.2"
                                Text="{Binding Description}"
                                TextColor="{StaticResource TextSecondary}" />
                        </Border>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </VerticalStackLayout>
        </ScrollView>

        <Grid
            Grid.Row="1"
            Padding="24,10,24,24"
            ColumnDefinitions="*,Auto"
            ColumnSpacing="16">

            <Button
                Grid.Column="0"
                BackgroundColor="{StaticResource NeonAccent}"
                Clicked="OnEditClicked"
                CornerRadius="8"
                FontAttributes="Bold"
                FontFamily="HeaderFont"
                HeightRequest="50"
                Text="EDIT DATA"
                TextColor="{StaticResource Black}" />

            <Button
                Grid.Column="1"
                BackgroundColor="Transparent"
                BorderColor="{StaticResource Magenta}"
                BorderWidth="1"
                Clicked="OnDeleteClicked"
                CornerRadius="8"
                FontFamily="HeaderFont"
                FontSize="20"
                HeightRequest="50"
                Text="ðŸ—‘"
                TextColor="{StaticResource Magenta}"
                WidthRequest="60" />
        </Grid>
    </Grid>
</ContentPage>